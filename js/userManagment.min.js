const back4appAppId="gtdHhx99C3WkxE5EWFi8NN3M8u3MBVXc0sQk5y7C",back4appJsKey="EQrq2RH5VZ8FBRuq2t21OSkuSYiTXTXWVpuYyZot";let currentUser,chosenCharacterArr=[],userLoggedIn=!1,favorites=!1;function goToSignUp(){$("body").css("pointer-events","none"),$(".infinityGauntlet, #signUpBtn").hide(),$(window).width()<765&&$("#header").hide(),$("html, body").css({background:"url(./images/background9.jpg) no-repeat center center fixed","background-size":"cover"}),$("#mainContent, .searchContainer").hide(),$.get("signUpForm.html",function(e){$("#signUpFormWrapper").show(),$("#signUpFormWrapper").append(e),setTimeout(function(){$("body").css("pointer-events","all")},1e3)})}function showSignInForm(){$("#signInSection").show(),$("#signUpSection, #forgotPassSection").hide()}function showSignUpForm(){$("#signUpSection").show(),$("#signInSection").hide()}function showResetPassForm(){$("#forgotPassSection").show(),$("#signInSection").hide()}function signUp(){valid=!0;let e=$("#usernameSignUp").val(),t=$("#emailSignUp").val(),r=$("#passwordSignUp").val();if((""==e||e.length<2)&&($("#usernameSignUp").css({border:"1px solid #FF4545"}),valid=!1),""!=t&&null!=t&&0!=t&&/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(t)||($("#emailSignUp").css({border:"1px solid #FF4545"}),valid=!1),(""==r||r.length<6)&&($("#passwordSignUp").css({border:"1px solid #FF4545"}),$("body").css("pointer-events","none"),$("#passErrorSignIn").fadeIn(),setTimeout(function(){$("body").css("pointer-events","all"),$("#passErrorSignIn").fadeOut()},2e3),valid=!1),valid){null!==Parse.User.current()&&Parse.User.logOut(),localStorage.clear();var n=new Parse.User;currentUser=n,n.set("username",e),n.set("password",r),n.set("email",t),n.set("characters",chosenCharacterArr),n.signUp().then(function(e){showSignInForm()}).catch(function(e){console.log("Error: "+e.code+" "+e.message)})}}function logIn(e){valid=!0;let t=$("#usernameSignIn").val(),r=$("#passwordSignIn").val();if((""==t||t.length<2)&&($("#usernameSignIn").css({border:"1px solid #FF4545"}),valid=!1),(""==r||r.length<6)&&($("#passwordSignIn").css({border:"1px solid #FF4545"}),$("body").css("pointer-events","none"),$("#passErrorLogIn").fadeIn(),setTimeout(function(){$("body").css("pointer-events","all"),$("#passErrorLogIn").fadeOut()},2e3),valid=!1),valid){localStorage.clear();Parse.User.logIn(t,r).then(function(e){currentUser=e;let t=e.get("characters");chosenCharacterArr=t,$.each($(".heroWrapper"),function(e,r){$("<img>",{class:"addToFavoritesBtn",src:"./images/emptyStar.webp",alt:"star",click:function(){"./images/emptyStar.webp"==$(this).attr("src")?$(this).attr("src","./images/fullStar.webp"):$(this).attr("src","./images/emptyStar.webp"),addToFavorites(Number($(this).parent().parent().attr("id").replace("character","")))}}).appendTo($(r).find($(".characterBtnWrapper")));$(window).width()<765&&($(r).find($(".characterBtn")).addClass("characterBtnLoggedIn"),$(r).find($(".addToFavoritesBtn")).addClass("addToFavoritesBtnLoggedIn"));let n=$(r).attr("id").replace("character","");if(t.includes(Number(n))){let e=$(r).find($(".addToFavoritesBtn"));$(e).attr("src","./images/fullStar.webp")}}),$(".menuOpenWrapper").show(),$("#header").hide(),$("body").css("pointer-events","none"),setTimeout(function(){$("body").css("pointer-events","all")},2e3),$("#signUpBtn").hide(),userLoggedIn=!0,$("#userNameHeader").html("Hello, "+capitalize(e.get("username"))).show(),goHome(2)}).catch(function(e){205==e.code?($("body").css("pointer-events","none"),$(".signUpButton").html("Please Verify Your Email"),$(".signUpButton").css({color:"red",background:"white"}),setTimeout(function(){$("body").css("pointer-events","all"),$(".signUpButton").html("Log In"),$(".signUpButton").css({color:"white",background:"linear-gradient(#333, #222)"})},2e3)):101==e.code?($("body").css("pointer-events","none"),$(".signUpButton").html("Check Username/Password"),$(".signUpButton").css({color:"red",background:"white"}),setTimeout(function(){$("body").css("pointer-events","all"),$(".signUpButton").html("Log In"),$(".signUpButton").css({color:"white",background:"linear-gradient(#333, #222)"})},2e3)):console.log("Error: "+e.code+" "+e.message)})}}function logOut(){localStorage.clear(),chosenCharacterArr=[];Parse.User.logOut().then(function(e){currentUser=e,$(window).width()<765?$("#header").show():$("#signUpBtn").show(),1==heroes&&$(".heroWrapper").fadeIn(),$(".addToFavoritesBtn").remove(),$(".menuOpenWrapper, #userNameHeader").hide(),$(".characterBtn").removeClass("characterBtnLoggedIn"),$("#userNameHeader").html(""),userLoggedIn=!1})}function resetPassword(){valid=!0;let e=$("#emailForgotPass").val();""!=e&&null!=e&&0!=e&&/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)||($("#emailForgotPass").css({border:"1px solid #FF4545"}),valid=!1),valid&&Parse.User.requestPasswordReset(e).then(function(){$("#emailWasSent").fadeIn(),setTimeout(function(){$("#emailWasSent").fadeOut(),showSignInForm()},2e3)}).catch(function(e){console.log("The login failed with error: "+e.code+" "+e.message)})}function addToFavorites(e){if(chosenCharacterArr.includes(e)){let t=chosenCharacterArr.indexOf(e);chosenCharacterArr.splice(t,1),currentUser.set("characters",chosenCharacterArr).save()}else chosenCharacterArr.push(e),currentUser.set("characters",chosenCharacterArr).save()}function showFavorites(e){$("body").css("pointer-events","none");let t=currentUser.get("characters");null==t&&(t=[]),1==e?($("#time2").is(":visible")?($("#time2").click(),setTimeout(function(){$.each($(".heroWrapper"),function(e,r){let n=$(r).attr("id").replace("character","");t.includes(Number(n))?($("#marvelContainer .infinityGauntlet").hide(),$(".addToFavoritesBtn").fadeOut(),$(".characterBtn").removeClass("characterBtnLoggedIn")):$(r).fadeOut("slow")}),$("#favoritesBtn").attr("onclick","showFavorites(2)"),$("#favoritesBtn").html("Show All"),e=2,$("body").css("pointer-events","all")},3e3)):($.each($(".heroWrapper"),function(e,r){let n=$(r).attr("id").replace("character","");t.includes(Number(n))?($("#marvelContainer .infinityGauntlet").hide(),$(".addToFavoritesBtn").fadeOut(),$(".characterBtn").removeClass("characterBtnLoggedIn")):$(r).fadeOut("slow")}),$("#favoritesBtn").attr("onclick","showFavorites(2)"),$("#favoritesBtn").html("Show All"),e=2,$("body").css("pointer-events","all")),favorites=!0):($("#marvelContainer .infinityGauntlet").show(),$(".heroWrapper").fadeIn(),$(".addToFavoritesBtn").fadeIn(),$(".characterBtn").addClass("characterBtnLoggedIn"),$("#favoritesBtn").attr("onclick","showFavorites(1)"),$("#favoritesBtn").html("Show Favorites"),e=1,setTimeout(function(){$("body").css("pointer-events","all")},1e3),favorites=!1)}function goToMyAccount(){$("body").css("pointer-events","none"),$(".infinityGauntlet, #signUpBtn, #userNameHeader, .menuOpenWrapper").hide(),$("html, body").css({background:"url(./images/background9.jpg) no-repeat center center fixed","background-size":"cover"}),$("#mainContent, .searchContainer").hide(),$.get("myAccount.html",function(e){$("#myAccountWrapper").show(),$("#myAccountWrapper").append(e),setTimeout(function(){$("body").css("pointer-events","all")},1e3)})}function changeUsername(){valid=!0;let e=$("#usernameAccount").val();(""==e||e.length<2)&&($("#usernameAccount").css({border:"1px solid #FF4545"}),valid=!1),valid&&(currentUser.set("username",e).save(),$("#userNameHeader").html(capitalize(e)),goHome(2))}$(document).ready(function(e){if(Parse.initialize(back4appAppId,back4appJsKey),Parse.serverURL="https://parseapi.back4app.com/",null!==Parse.User.current()){currentUser=Parse.User.current(),userLoggedIn=!0;var t=currentUser.get("characters");null==t&&(t=[]),chosenCharacterArr=t,$("#header").hide(),setTimeout(function(){$.each($(".heroWrapper"),function(e,r){$("<img>",{class:"addToFavoritesBtn",src:"./images/emptyStar.webp",alt:"star",click:function(){"./images/emptyStar.webp"==$(this).attr("src")?$(this).attr("src","./images/fullStar.webp"):$(this).attr("src","./images/emptyStar.webp"),addToFavorites(Number($(this).parent().parent().attr("id").replace("character","")))}}).appendTo($(r).find($(".characterBtnWrapper")));$(window).width()<765&&($(r).find($(".characterBtn")).addClass("characterBtnLoggedIn"),$(r).find($(".addToFavoritesBtn")).addClass("addToFavoritesBtnLoggedIn"));let n=$(r).attr("id").replace("character","");if(void 0!==t&&t.includes(Number(n))){let e=$(r).find($(".addToFavoritesBtn"));$(e).attr("src","./images/fullStar.webp")}})},2e3),$(".menuOpenWrapper").show(),$("#userNameHeader").html("Hello, "+capitalize(currentUser.get("username"))).show(),$("#signUpBtn").hide()}});
